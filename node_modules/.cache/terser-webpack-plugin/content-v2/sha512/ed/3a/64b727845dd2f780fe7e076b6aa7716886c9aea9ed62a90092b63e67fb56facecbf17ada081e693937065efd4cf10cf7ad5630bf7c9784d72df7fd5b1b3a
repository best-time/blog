{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[293],{833:function(t,a,e){\"use strict\";e.r(a);var s=e(12),v=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[e(\"h3\",{attrs:{id:\"富文本编辑器的层级\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#富文本编辑器的层级\"}},[t._v(\"#\")]),t._v(\" 富文本编辑器的层级\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"L0\")]),t._v(\" \"),e(\"li\",[t._v(\"L1: 兼容性层面的优化, 自行实现 undo/redo 栈;\")]),t._v(\" \"),e(\"li\",[t._v(\"L2: 移动端/国际化适配;\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"一个好的框架设计: 尽量少的提前做的假设限制!\")])]),t._v(\" \"),e(\"h4\",{attrs:{id:\"l0\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#l0\"}},[t._v(\"#\")]),t._v(\" L0\")]),t._v(\" \"),e(\"ol\",[e(\"li\",[t._v(\"给元素上加上 \"),e(\"code\",[t._v(\"contenteditable\")]),t._v(\" 属性\")]),t._v(\" \"),e(\"li\",[t._v(\"给选中元素执行 \"),e(\"code\",[t._v(\"document.execCommand()\")])])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"另外一种方法是内嵌 iframe, 并将其 designmode 属性设置为 true。(有跨域问题, 日后填坑)\")])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"slate-框架\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#slate-框架\"}},[t._v(\"#\")]),t._v(\" Slate 框架\")]),t._v(\" \"),e(\"h3\",{attrs:{id:\"调试\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#调试\"}},[t._v(\"#\")]),t._v(\" 调试\")]),t._v(\" \"),e(\"p\",[t._v(\"可以使用 \"),e(\"code\",[t._v(\"editor.value.toJSON()\")]),t._v(\" 打印 tree 结构, 便于调试;\")]),t._v(\" \"),e(\"h3\",{attrs:{id:\"slate-设计模式\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#slate-设计模式\"}},[t._v(\"#\")]),t._v(\" slate 设计模式\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"兜底原则\\n\"),e(\"ul\",[e(\"li\",[e(\"code\",[t._v(\"normalizeNode\")]),t._v(\", 除指定节点外都走该 normalize 机制;\")])])])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"有序列表的设计\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#有序列表的设计\"}},[t._v(\"#\")]),t._v(\" 有序列表的设计\")]),t._v(\" \"),e(\"ol\",[e(\"li\",[t._v(\"小圆点 + 数字作为一个结构;\")]),t._v(\" \"),e(\"li\",[t._v(\"点击有序列表, 当前节点的同级兄弟节点都会变为有序列表;\")]),t._v(\" \"),e(\"li\",[t._v(\"点击可以取消有序列表;\")]),t._v(\" \"),e(\"li\",[t._v(\"当在有序列表的节点建立兄弟节点或子节点时, 自动设置为有序列表;\")]),t._v(\" \"),e(\"li\",[t._v(\"子节点规则 1 —— 1.1 —— 1.1.1 —— 1.1.1.1;\")]),t._v(\" \"),e(\"li\",[t._v(\"当把某个子节点从有序节点变为无序节点时, 该节点的兄弟节点也变为无序; 该节点的子节点从 1 开始计数;\")]),t._v(\" \"),e(\"li\",[t._v(\"原则: 兄弟节点必须都为有序或无序, 子节点可以无序也可以有序;\")])]),t._v(\" \"),e(\"p\",[t._v(\"结论:\")]),t._v(\" \"),e(\"ol\",[e(\"li\",[t._v(\"因此对 selection 是不敏感的, 即操作一个都会同时对同层级所有节点生效;\")])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"slate-开发坑点\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#slate-开发坑点\"}},[t._v(\"#\")]),t._v(\" slate 开发坑点\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"一种方式开发完之后, 在某些情况下是不满足的, 因此需要返工。\\n\"),e(\"ul\",[e(\"li\",[t._v(\"example: 输入 @、# 进行筛选最初是使用 set 方式实现的, 一开始这样设计是没问题的, 但是考虑未来在多人协作过程中会造成一份数据的互相影响, 因此将其重构调整为将筛选的数据绕开 set 的方式, 取而代之的是外面传递进来。\")])])])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"small-tip\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#small-tip\"}},[t._v(\"#\")]),t._v(\" small tip\")]),t._v(\" \"),e(\"p\",[t._v(\"small tip in slate editor\")]),t._v(\" \"),e(\"p\",[t._v(\"When input b after a in page #slate #editor.\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-js extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[e(\"code\",[t._v(\"console\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"log\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"editor\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"value\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"texts\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"get\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"   \"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//  'a';\")]),t._v(\"\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"requestAnimationFrame\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=>\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  console\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"log\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"editor\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"value\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"texts\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"get\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 'ab'\")]),t._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\")])])]),e(\"h3\",{attrs:{id:\"web-excel\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#web-excel\"}},[t._v(\"#\")]),t._v(\" Web Excel\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"Google Sheets\")]),t._v(\" \"),e(\"li\",[t._v(\"Office 365\")]),t._v(\" \"),e(\"li\",[t._v(\"WPS Web\")]),t._v(\" \"),e(\"li\",[t._v(\"钉钉表格\\n\"),e(\"ul\",[e(\"li\",[t._v(\"可扩展的表格\\n\"),e(\"ul\",[e(\"li\",[t._v(\"棋盘模型\\n\"),e(\"ul\",[e(\"li\",[t._v(\"Range 模型\")])])])])]),t._v(\" \"),e(\"li\",[t._v(\"协同的表格\\n\"),e(\"ul\",[e(\"li\",[t._v(\"名词\\n\"),e(\"ul\",[e(\"li\",[t._v(\"cp(Check Point): 全量表格数据\")]),t._v(\" \"),e(\"li\",[t._v(\"op(Operation): 单次操作的表达\")])])]),t._v(\" \"),e(\"li\",[t._v(\"OT(Operation Transform) 是协同算法的关键。\")]),t._v(\" \"),e(\"li\",[t._v(\"上限更高的 COT 调度算法要求 OT 同时运行在服务端与客户端\")]),t._v(\" \"),e(\"li\",[t._v(\"Rust + WASM 实现 OT, 已验证最小闭环\")])])]),t._v(\" \"),e(\"li\",[t._v(\"高性能的表格\\n\"),e(\"ul\",[e(\"li\",[t._v(\"选择 canvas 渲染表格主界面, 不用 DOM 的原因是浪费在 DOM Pipeline 的开销很大\")]),t._v(\" \"),e(\"li\",[t._v(\"分层渲染管线\")]),t._v(\" \"),e(\"li\",[t._v(\"双缓冲画布, 支持流畅的滚动\")]),t._v(\" \"),e(\"li\",[t._v(\"自研排版引擎\")])])])])])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"协同编辑\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#协同编辑\"}},[t._v(\"#\")]),t._v(\" 协同编辑\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[e(\"p\",[e(\"a\",{attrs:{href:\"https://github.com/ether/etherpad-lite\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"etherpad-lite\"),e(\"OutboundLink\")],1)]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"基于 OT 开发的从底层支持协同编辑的框架。\")]),t._v(\" \"),e(\"li\",[t._v(\"代表: 飞书、石墨\")]),t._v(\" \"),e(\"li\",[t._v(\"问题: 十年前代码、技术栈陈旧\")]),t._v(\" \"),e(\"li\",[t._v(\"核心方法:\\n\"),e(\"ul\",[e(\"li\",[t._v(\"apply\")]),t._v(\" \"),e(\"li\",[t._v(\"compose\")]),t._v(\" \"),e(\"li\",[t._v(\"follow: 解决两个 changeset 冲突问题\")]),t._v(\" \"),e(\"li\",[t._v(\"inverse: 反操作, undo\")])])])])]),t._v(\" \"),e(\"li\",[e(\"p\",[t._v(\"Changeset\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"代表对文档的一次修改\")]),t._v(\" \"),e(\"li\",[t._v(\"eg: Z:4>1=1*0+1$2\\n\"),e(\"ul\",[e(\"li\",[t._v(\"Z: 代表是一个 Changeset\")]),t._v(\" \"),e(\"li\",[t._v(\"4>1: 源文档 4 个字符长度, 本次修改增加一个字符\")]),t._v(\" \"),e(\"li\",[t._v(\"=1: 跳过第一个字符\")]),t._v(\" \"),e(\"li\",[t._v(\"*0+1: 插入一个字符, 并且带上属性 0\")]),t._v(\" \"),e(\"li\",[t._v(\"$2: 插入的具体字符\")])])]),t._v(\" \"),e(\"li\",[e(\"a\",{attrs:{href:\"https://github.com/marcelklehr/changesets\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Changeset Iterator\"),e(\"OutboundLink\")],1),t._v(\", 解析上述 Changeset 的库\")])])]),t._v(\" \"),e(\"li\",[e(\"p\",[t._v(\"渲染流程\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"内联属性\")]),t._v(\" \"),e(\"li\",[t._v(\"行属性: 标题\")]),t._v(\" \"),e(\"li\",[t._v(\"块属性: 图片\")])])]),t._v(\" \"),e(\"li\",[e(\"p\",[t._v(\"问题一: follow 为什么要对 A 与 B 都要处理, 可否只对一处进行处理?\")])]),t._v(\" \"),e(\"li\",[e(\"p\",[t._v(\"问题二: etherpad-lite 服务端与客户端协同的处理? (要有一个 master)\")]),t._v(\" \"),e(\"ol\",[e(\"li\",[t._v(\"服务端设置为 true\")]),t._v(\" \"),e(\"li\",[t._v(\"客户端设置为 false\")])])]),t._v(\" \"),e(\"li\",[e(\"p\",[t._v(\"问题三:\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"弱网情况下, 如何优化协同问题? (比如输入拼音, 被截断, 无法删除)\")])])])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"link\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#link\"}},[t._v(\"#\")]),t._v(\" link\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[e(\"a\",{attrs:{href:\"https://zhuanlan.zhihu.com/p/90931631\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"编辑器初体验\"),e(\"OutboundLink\")],1)])])])}),[],!1,null,null,null);a.default=v.exports}}]);","extractedComments":[]}